CREATE TABLE `COMMON_CODES` (
	`FK_COMMON_CODES`	VARCHAR(50)	NOT NULL,
	`PART_NAME`	VARCHAR(255)	NULL,
	`NAME`	VARCHAR(255)	NULL
);
CREATE TABLE `USERS` (
	`PK_USERS`	VARCHAR(50)	NOT NULL,
	`NAME`	VARCHAR(255)	NULL,
	`PHONE`	VARCHAR(255)	NULL,
	`EMAIL`	VARCHAR(255)	NULL,
	`FK_COMMON_CODES`	VARCHAR(255)	NULL
);
CREATE TABLE `DELIVERY_PLACES` (
	`PK_DELIVERY_PLACES`	VARCHAR(50)	NOT NULL,
	`PK_USERS`	VARCHAR(50)	NOT NULL,
	`FK_COMMON_CODES`	VARCHAR(50)	NULL
);
ALTER TABLE `COMMON_CODES` ADD CONSTRAINT `PK_COMMON_CODES` PRIMARY KEY (
	`FK_COMMON_CODES`
);
ALTER TABLE `USERS` ADD CONSTRAINT `PK_USERS` PRIMARY KEY (
	`PK_USERS`
);
ALTER TABLE `DELIVERY_PLACES` ADD CONSTRAINT `PK_DELIVERY_PLACES` PRIMARY KEY (
	`PK_DELIVERY_PLACES`,
	`PK_USERS`
);
ALTER TABLE `DELIVERY_PLACES` ADD CONSTRAINT `FK_USERS_TO_DELIVERY_PLACES_1` FOREIGN KEY (
	`PK_USERS`
)
REFERENCES `USERS` (
	`PK_USERS`
);


-- ------------------------------------

INSERT INTO `USERS` (`PK_USERS`, `NAME`, `PHONE`, `EMAIL`, `FK_COMMON_CODES`) VALUES
('PK_U_01', '홍길동', '010-1234-5678', 'hong@example.com', 'PK_G_01'),
('PK_U_02', '김영희', '010-9876-5432', 'kim@example.com', 'PK_G_02'),
('PK_U_03', '박민준', '010-8642-9137', 'park@example.com', 'PK_G_01'),
('PK_U_04', '임지영', '010-5793-6241', 'lim@example.com', 'PK_G_02');

INSERT INTO `COMMON_CODES` (`FK_COMMON_CODES`, `PART_NAME`, `NAME`) VALUES
('PK_D_01', 'DELIVERY', '서울특별시 강남구'),
('PK_D_02', 'DELIVERY', '경기도 수원시'),
('PK_D_04', 'DELIVERY', '대전광역시 서구'),
('PK_D_05', 'DELIVERY', '경상북도 포항시 북구'),
('PK_G_01', 'GENDER', '남'),
('PK_G_02', 'GENDER', '여');

INSERT INTO `DELIVERY_PLACES` (`PK_DELIVERY_PLACES`, `PK_USERS`, `FK_COMMON_CODES`) VALUES
('DP_01', 'PK_U_01', 'PK_D_01'),
('DP_02', 'PK_U_02', 'PK_D_02'),
('DP_03', 'PK_U_03', 'PK_D_04'),
('DP_04', 'PK_U_04', 'PK_D_05'),
('DP_05', 'PK_U_01', 'PK_D_02'),
('DP_06', 'PK_U_04', 'PK_D_04');

SELECT *
FROM COMMON_CODES;

-- ------------------------------------

SELECT USERS.*
	, DP.FK_COMMON_CODES AS FK_ADDRESS
    , CC.NAME
    , CC_GENDER.NAME
FROM USERS
	JOIN DELIVERY_PLACES DP
    ON DP.PK_USERS = USERS.PK_USERS
	JOIN COMMON_CODES CC
    ON CC.FK_COMMON_CODES = DP.FK_COMMON_CODES
	JOIN COMMON_CODES CC_GENDER
    ON CC_GENDER.FK_COMMON_CODES = USERS.FK_COMMON_CODES
;	




